<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Шашки</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      margin: 0;
      padding: 0;
      background-color: #f0f0f0;
      font-family: Arial, sans-serif;
    }
    .header {
      width: 100%;
      padding: 10px;
      background-color: #333;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .room-list {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding: 10px;
    }
    .room {
      padding: 10px;
      background-color: #007bff;
      color: white;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      min-width: 80px;
    }
    .room.full {
      background-color: #dc3545;
      cursor: not-allowed;
    }
    .game-container {
      display: flex;
      margin-top: 20px;
      gap: 20px;
    }
    .board {
      display: grid;
      grid-template-columns: repeat(8, 80px);
      grid-template-rows: repeat(8, 80px);
      border: 2px solid #333;
    }
    .cell {
      width: 80px;
      height: 80px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .cell:nth-child(odd):nth-child(even),
    .cell:nth-child(even):nth-child(odd) {
      background-color: #769656;
    }
    .cell:nth-child(odd):nth-child(odd),
    .cell:nth-child(even):nth-child(even) {
      background-color: #eeeed2;
    }
    .piece {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      cursor: grab;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-weight: bold;
    }
    .piece.black {
      background-color: black;
    }
    .piece.white {
      background-color: white;
    }
    .piece.king::after {
      content: "♛";
      font-size: 36px;
    }
    .chat {
      width: 300px;
      display: flex;
      flex-direction: column;
      border: 2px solid #333;
      border-radius: 8px;
      background-color: white;
      overflow: hidden;
    }
    .chat-messages {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      background-color: #f9f9f9;
      max-height: 500px;
    }
    .chat-input {
      display: flex;
      padding: 10px;
      border-top: 1px solid #ccc;
      background-color: #fff;
    }
    .chat-input input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .chat-input button {
      margin-left: 10px;
      padding: 10px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Шашки</h1>
    <div class="room-list" id="roomList"></div>
  </div>
  <div class="game-container">
    <div class="board" id="board"></div>
    <div class="chat">
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input">
        <input type="text" id="chatInput" placeholder="Введите сообщение">
        <button id="chatSend">Отправить</button>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    const roomList = document.getElementById("roomList");
    const board = document.getElementById("board");
    const chatMessages = document.getElementById("chatMessages");
    const chatInput = document.getElementById("chatInput");
    const chatSend = document.getElementById("chatSend");

    let currentRoom = null;
    let playerColor = null;
    let boardState = Array(8).fill(null).map(() => Array(8).fill(null));
    let turn = "white"; // Keep track of whose turn it is

    // Initialize rooms
    const rooms = Array.from({ length: 10 }, (_, i) => ({ players: [], id: i }));
    rooms.forEach(room => {
      const roomDiv = document.createElement("div");
      roomDiv.classList.add("room");
      roomDiv.textContent = `Комната ${room.id + 1}`;
      roomDiv.onclick = () => joinRoom(room.id);
      roomList.appendChild(roomDiv);
    });

    function joinRoom(roomId) {
      const room = rooms[roomId];
      if (room.players.length >= 2) {
        alert("Комната заполнена!");
        return;
      }

      currentRoom = room;
      room.players.push(prompt("Введите свое имя:"));
      playerColor = room.players.length === 1 ? "white" : "black";
      updateRooms();
      if (room.players.length === 2) startGame();
    }

    function updateRooms() {
      document.querySelectorAll(".room").forEach((roomDiv, index) => {
        const room = rooms[index];
        roomDiv.textContent = `Комната ${room.id + 1} (${room.players.length}/2)`;
      });
    }

    // Initialize board
    function initializeBoard() {
      board.innerHTML = "";
      for (let row = 0; row < 8; row++) {
        for (let col = 0; col < 8; col++) {
          const cell = document.createElement("div");
          cell.classList.add("cell");
          cell.dataset.row = row;
          cell.dataset.col = col;

          if ((row + col) % 2 === 1) {
            if (row < 3) {
              const piece = createPiece("black");
              boardState[row][col] = piece;
              cell.appendChild(piece);
            } else if (row > 4) {
              const piece = createPiece("white");
              boardState[row][col] = piece;
              cell.appendChild(piece);
            }
          }

          board.appendChild(cell);
        }
      }
    }

    function createPiece(color) {
      const piece = document.createElement("div");
      piece.classList.add("piece", color);
      piece.draggable = true;
      piece.addEventListener("dragstart", dragStart);
      return piece;
    }

    // Drag and Drop
    let draggedPiece = null;
    let sourceCell = null;

    function dragStart(e) {
      draggedPiece = e.target;
      sourceCell = draggedPiece.parentElement;
      setTimeout(() => (draggedPiece.style.visibility = "hidden"), 0);
    }

    board.addEventListener("dragover", e => e.preventDefault());

    board.addEventListener("drop", e => {
      const targetCell = e.target;
      if (targetCell.classList.contains("cell") && isValidMove(sourceCell, targetCell)) {
        targetCell.appendChild(draggedPiece);
        draggedPiece.style.visibility = "visible";
        updateTurn();
      }
    });

    function isValidMove(source, target) {
      // Implement logic for valid moves
      return true; // Placeholder
    }

    function updateTurn() {
      turn = turn === "white" ? "black" : "white";
    }

    // Chat
    chatSend.addEventListener("click", () => {
      const message = chatInput.value;
      if (message.trim()) {
        addMessage(`Вы: ${message}`);
        chatInput.value = "";
      }
    });

    function addMessage(message) {
      const msgDiv = document.createElement("div");
      msgDiv.textContent = message;
      chatMessages.appendChild(msgDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function startGame() {
      alert("Игра началась!");
      initializeBoard();
    }
  </script>
</body>
</html>
